# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- develop

pool:
  name: 'k8s-pool'
  demands:
    - maven
   
stages:
 - stage: 'build stage'
   jobs:
     - job: 'build job'
       steps:
       - task: Maven@4
         inputs:
           mavenPomFile: 'pom.xml'
           publishJUnitResults: true
           testResultsFiles: '**/surefire-reports/TEST-*.xml'
           javaHomeOption: 'JDKVersion'
           mavenVersionOption: 'Default'
           mavenAuthenticateFeed: false
           effectivePomSkip: false
           sonarQubeRunAnalysis: false
       - task: CopyFiles@2
         inputs:
           contents: 'target/bermtec-0.0.1.war'  # Path to your artifact
           targetFolder: '/home/azureuser/artifact'  # The dedicated folder
       - task: PublishBuildArtifacts@1
         inputs:
           pathToPublish: '/home/azureuser/artifact'
           artifactName: 'bermtec-artifact'
           publishLocation: 'container'
